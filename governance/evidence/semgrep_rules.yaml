rules:
  - id: llm-call-site
    languages:
      - python
    message: LLM call site detected
    severity: INFO
    patterns:
      - pattern: $CLIENT.call_llm($PROMPT)
    metadata:
      category: governance
      promise_id: llm-input-logging
      evidence_type: static_analysis

  - id: llm-call-must-log
    languages:
      - python
    message: LLM call detected without subsequent logging
    severity: ERROR
    patterns:
      - pattern: $CLIENT.call_llm($PROMPT)
      - pattern-not-inside: |
          $CLIENT.call_llm($PROMPT)
          ...
          log($PROMPT, ...)
    metadata:
      category: governance
      promise_id: llm-input-logging
      evidence_type: static_analysis

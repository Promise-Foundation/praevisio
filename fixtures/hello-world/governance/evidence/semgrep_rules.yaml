rules:
  - id: llm-call-site
    languages: [python]
    message: LLM call site detected
    severity: INFO
    patterns:
      - pattern: call_llm($PROMPT)

  - id: llm-call-must-log
    languages: [python]
    message: LLM call detected without prior logging
    severity: ERROR
    patterns:
      - pattern: call_llm($PROMPT)
      - pattern-not-inside: |
          log($PROMPT, $LOG_PATH)
          ...
          call_llm($PROMPT)
